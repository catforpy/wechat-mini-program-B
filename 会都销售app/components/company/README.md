# å…¬å¸åˆ—è¡¨ç‰ˆä½“ä½¿ç”¨æ‰‹å†Œ

## æ¦‚è¿°

æœ¬æ¨¡å—æä¾›äº†ä¸¤ç§ä¸åŒçš„å…¬å¸åˆ—è¡¨ç‰ˆä½“ç»„ä»¶ï¼Œç”¨äºå±•ç¤º"æˆ‘çš„å…¬å¸"é¡µé¢ä¸­çš„å…¬å¸å’Œå…¶å¯¹åº”çš„å°ç¨‹åºã€‚

## ç‰ˆä½“å¯¹æ¯”

### ç‰ˆä½“1 (CompanyListLayout1) - å†…è”æŒ‰é’®ç‰ˆ

**æ–‡ä»¶ä½ç½®**: `components/company/CompanyListLayout1.vue`

**ç‰¹ç‚¹**:
- âœ… "æ·»åŠ å°ç¨‹åº"æŒ‰é’®ä½äºæ¯ä¸ªå…¬å¸å±•å¼€åçš„åˆ—è¡¨åº•éƒ¨
- âœ… æ ¹æ®æŒ‰é’®æ‰€åœ¨å…¬å¸ç±»å‹**è‡ªåŠ¨ç­›é€‰**ä¸‹æ‹‰åˆ—è¡¨
- âœ… ä¸Šä¸‹æ–‡å…³è”æ€§å¼ºï¼Œç”¨æˆ·æ˜ç¡®çŸ¥é“ä¸ºå“ªä¸ªå…¬å¸æ·»åŠ å°ç¨‹åº

**ç­›é€‰é€»è¾‘**:
```
ç‚¹å‡»å¤ªæ¹–å­¦é™¢ï¼ˆä¼ä¸šç±»å‹ï¼‰ä¸‹çš„"æ·»åŠ å°ç¨‹åº"
  â†’ å¼¹çª—ä¸‹æ‹‰åˆ—è¡¨åªæ˜¾ç¤ºä¼ä¸šç±»å‹çš„å·²è®¤è¯ä¼ä¸š

ç‚¹å‡»ç‹è®°å°åƒåº—ï¼ˆä¸ªä½“å·¥å•†æˆ·ç±»å‹ï¼‰ä¸‹çš„"æ·»åŠ å°ç¨‹åº"
  â†’ å¼¹çª—ä¸‹æ‹‰åˆ—è¡¨åªæ˜¾ç¤ºä¸ªä½“å·¥å•†æˆ·ç±»å‹çš„å·²è®¤è¯ä¼ä¸š

ç‚¹å‡»ä¼˜é€‰å•†åŸï¼ˆç”µå­å•†åŠ¡ç±»å‹ï¼‰ä¸‹çš„"æ·»åŠ å°ç¨‹åº"
  â†’ å¼¹çª—ä¸‹æ‹‰åˆ—è¡¨åªæ˜¾ç¤ºç”µå­å•†åŠ¡ç±»å‹çš„å·²è®¤è¯ä¼ä¸š
```

**é€‚ç”¨åœºæ™¯**:
- ç”¨æˆ·ä¸»è¦å›´ç»•ç‰¹å®šå…¬å¸è¿›è¡Œæ“ä½œ
- éœ€è¦å¼ºè°ƒå°ç¨‹åºä¸æ‰€å±å…¬å¸çš„å…³è”
- å·²è®¤è¯ä¼ä¸šæ•°é‡è¾ƒå¤šï¼Œéœ€è¦å‡å°‘é€‰æ‹©èŒƒå›´

**ä¼˜åŠ¿**:
- ğŸ¯ ç²¾å‡†ç­›é€‰ï¼Œå‡å°‘ç”¨æˆ·é€‰æ‹©å›°æƒ‘
- ğŸ¯ ä¸Šä¸‹æ–‡æ¸…æ™°ï¼Œæ“ä½œæ„å›¾æ˜ç¡®
- ğŸ¯ ç¬¦åˆç”¨æˆ·å¿ƒæ™ºæ¨¡å‹

**åŠ£åŠ¿**:
- âš ï¸ éœ€è¦å±•å¼€å…¬å¸æ‰èƒ½çœ‹åˆ°æŒ‰é’®
- âš ï¸ é•¿åˆ—è¡¨å¯èƒ½éœ€è¦å¤šæ¬¡æ»šåŠ¨

---

### ç‰ˆä½“2 (CompanyListLayout2) - é¡µé¢çº§æ‚¬æµ®æŒ‰é’®ç‰ˆ

**æ–‡ä»¶ä½ç½®**: `components/company/CompanyListLayout2.vue`

**ç‰¹ç‚¹**:
- âœ… "æ·»åŠ å°ç¨‹åº"æŒ‰é’®ä¸ºé¡µé¢å³ä¸‹è§’æ‚¬æµ®æŒ‰é’®ï¼ˆå›ºå®šä½ç½®ï¼‰
- âœ… ä¸‹æ‹‰åˆ—è¡¨æ˜¾ç¤º**æ‰€æœ‰ç±»å‹**çš„å·²è®¤è¯ä¼ä¸š
- âœ… ä¸å—åˆ—è¡¨æ»šåŠ¨å½±å“ï¼Œå§‹ç»ˆå¯è§å¯ç‚¹å‡»

**å½’ç±»é€»è¾‘**:
```
ç”¨æˆ·ç‚¹å‡»å³ä¸‹è§’æ‚¬æµ®æŒ‰é’®
  â†’ å¼¹çª—ä¸‹æ‹‰åˆ—è¡¨æ˜¾ç¤ºæ‰€æœ‰ç±»å‹çš„å·²è®¤è¯ä¼ä¸š
  â†’ ç”¨æˆ·é€‰æ‹©ä»»æ„ä¼ä¸šåç‚¹å‡»ç¡®å®š
  â†’ æ ¹æ®æ‰€é€‰ä¼ä¸šçš„ç±»å‹ï¼Œè‡ªåŠ¨å°†å°ç¨‹åºå½’ç±»åˆ°å¯¹åº”ç±»å‹çš„å…¬å¸ä¸‹
```

**é€‚ç”¨åœºæ™¯**:
- ç”¨æˆ·éœ€è¦é¢‘ç¹æ·»åŠ å°ç¨‹åº
- å…¬å¸åˆ—è¡¨è¾ƒé•¿ï¼Œä¸å¸Œæœ›æ¯æ¬¡éƒ½æ»šåŠ¨åˆ°åº•éƒ¨
- å·²è®¤è¯ä¼ä¸šæ•°é‡ä¸å¤šï¼Œä¸éœ€è¦ç­›é€‰

**ä¼˜åŠ¿**:
- ğŸš€ æŒ‰é’®å§‹ç»ˆå¯è§ï¼Œæ— éœ€æ»šåŠ¨
- ğŸš€ æ“ä½œæ›´å¿«æ·ï¼Œå‡å°‘ç‚¹å‡»æ¬¡æ•°
- ğŸš€ é€‚åˆé«˜é¢‘ä½¿ç”¨åœºæ™¯

**åŠ£åŠ¿**:
- âš ï¸ ç¼ºå°‘ä¸Šä¸‹æ–‡ï¼Œç”¨æˆ·éœ€è¦è®°ä½ä¸ºå“ªä¸ªå…¬å¸æ·»åŠ 
- âš ï¸ ä¸‹æ‹‰åˆ—è¡¨å¯èƒ½è¾ƒé•¿ï¼Œå¢åŠ é€‰æ‹©éš¾åº¦

---

## æ¥å£å®šä¹‰

### Props (ä¸¤ä¸ªç‰ˆä½“ç›¸åŒ)

```typescript
interface Props {
  companies: Company[]                  // å…¬å¸åˆ—è¡¨
  authenticatedCompanies: AuthenticatedCompany[]  // å·²è®¤è¯ä¼ä¸šåˆ—è¡¨
}

interface Company {
  id: string
  name: string
  type: 'enterprise' | 'individual' | 'shop' | 'ecommerce'
  typeLabel: string
  maxPrograms: number
  miniPrograms: MiniProgram[]
  expanded: boolean
}

interface AuthenticatedCompany {
  id: string
  name: string
  type: string
  typeLabel: string
}
```

### Events

#### ç‰ˆä½“1 Events

```typescript
emit('programClick', program: MiniProgram)
// å°ç¨‹åºè¢«ç‚¹å‡»æ—¶è§¦å‘

emit('addProgram', useNewCompany: boolean, company: AuthenticatedCompany | null, targetCompany: Company)
// æ·»åŠ å°ç¨‹åºç¡®è®¤æ—¶è§¦å‘
// - useNewCompany: true=ä½¿ç”¨æ–°æ³¨å†Œä¼ä¸š, false=ä½¿ç”¨å·²è®¤è¯ä¼ä¸š
// - company: é€‰ä¸­çš„å·²è®¤è¯ä¼ä¸šï¼ˆå¦‚æœuseNewCompanyä¸ºfalseï¼‰
// - targetCompany: ç›®æ ‡å…¬å¸ï¼ˆç‚¹å‡»æŒ‰é’®æ‰€åœ¨çš„å…¬å¸ï¼‰
```

#### ç‰ˆä½“2 Events

```typescript
emit('programClick', program: MiniProgram)
// å°ç¨‹åºè¢«ç‚¹å‡»æ—¶è§¦å‘

emit('addProgram', useNewCompany: boolean, company: AuthenticatedCompany | null)
// æ·»åŠ å°ç¨‹åºç¡®è®¤æ—¶è§¦å‘
// - useNewCompany: true=ä½¿ç”¨æ–°æ³¨å†Œä¼ä¸š, false=ä½¿ç”¨å·²è®¤è¯ä¼ä¸š
// - company: é€‰ä¸­çš„å·²è®¤è¯ä¼ä¸šï¼ˆåŒ…å«typeä¿¡æ¯ï¼Œç”¨äºè‡ªåŠ¨å½’ç±»ï¼‰
```

---

## ä½¿ç”¨ç¤ºä¾‹

### åœ¨ company-shop.vue ä¸­ä½¿ç”¨ç‰ˆä½“1

```vue
<template>
  <view class="company-shop-page">
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <view class="nav-bar" :style="{ paddingTop: statusBarHeight + 'px' }">
      <view class="nav-content">
        <view class="nav-back" @tap="goBack">
          <text class="back-icon">â†</text>
        </view>
        <view class="nav-title">æˆ‘çš„å…¬å¸</view>
        <view class="nav-action" @tap="addCompany">
          <text class="add-icon">+</text>
        </view>
      </view>
    </view>

    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <scroll-view class="main-content" scroll-y :style="{ paddingTop: (statusBarHeight + 88) + 'px' }">
      <CompanyListLayout1
        :companies="allCompanies"
        :authenticated-companies="authenticatedCompanies"
        @program-click="handleProgramClick"
        @add-program="handleAddProgram"
      />
    </scroll-view>
  </view>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import CompanyListLayout1 from '@/components/company/CompanyListLayout1.vue'
import type { Company, MiniProgram, AuthenticatedCompany } from '@/components/company/CompanyListLayout1.vue'

// å…¬å¸æ•°æ®
const allCompanies = ref<Company[]>([...])

// å·²è®¤è¯ä¼ä¸šæ•°æ®
const authenticatedCompanies = ref<AuthenticatedCompany[]>([...])

// å¤„ç†å°ç¨‹åºç‚¹å‡»
const handleProgramClick = (program: MiniProgram) => {
  uni.showToast({
    title: `æ‰“å¼€${program.name}`,
    icon: 'none'
  })
}

// å¤„ç†æ·»åŠ å°ç¨‹åº
const handleAddProgram = (
  useNewCompany: boolean,
  company: AuthenticatedCompany | null,
  targetCompany: Company
) => {
  if (useNewCompany) {
    // ä½¿ç”¨æ–°æ³¨å†Œä¼ä¸šï¼Œè·³è½¬åˆ°æ³¨å†Œé¡µé¢
    uni.navigateTo({
      url: '/pages/profile/company-registration-list'
    })
  } else {
    // ä½¿ç”¨å·²è®¤è¯ä¼ä¸šï¼Œä¸ºtargetCompanyæ·»åŠ å°ç¨‹åº
    uni.showToast({
      title: `ä¸º"${targetCompany.name}"ä½¿ç”¨"${company!.name}"æ·»åŠ å°ç¨‹åº`,
      icon: 'success'
    })
    // TODO: è°ƒç”¨APIæ·»åŠ å°ç¨‹åº
  }
}
</script>
```

### åœ¨ company-shop.vue ä¸­ä½¿ç”¨ç‰ˆä½“2

```vue
<template>
  <view class="company-shop-page">
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <view class="nav-bar" :style="{ paddingTop: statusBarHeight + 'px' }">
      <view class="nav-content">
        <view class="nav-back" @tap="goBack">
          <text class="back-icon">â†</text>
        </view>
        <view class="nav-title">æˆ‘çš„å…¬å¸</view>
        <view class="nav-action" @tap="addCompany">
          <text class="add-icon">+</text>
        </view>
      </view>
    </view>

    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <scroll-view class="main-content" scroll-y :style="{ paddingTop: (statusBarHeight + 88) + 'px' }">
      <CompanyListLayout2
        :companies="allCompanies"
        :authenticated-companies="authenticatedCompanies"
        @program-click="handleProgramClick"
        @add-program="handleAddProgram"
      />
    </scroll-view>
  </view>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import CompanyListLayout2 from '@/components/company/CompanyListLayout2.vue'
import type { Company, MiniProgram, AuthenticatedCompany } from '@/components/company/CompanyListLayout2.vue'

// å…¬å¸æ•°æ®
const allCompanies = ref<Company[]>([...])

// å·²è®¤è¯ä¼ä¸šæ•°æ®
const authenticatedCompanies = ref<AuthenticatedCompany[]>([...])

// å¤„ç†å°ç¨‹åºç‚¹å‡»
const handleProgramClick = (program: MiniProgram) => {
  uni.showToast({
    title: `æ‰“å¼€${program.name}`,
    icon: 'none'
  })
}

// å¤„ç†æ·»åŠ å°ç¨‹åº
const handleAddProgram = (
  useNewCompany: boolean,
  company: AuthenticatedCompany | null
) => {
  if (useNewCompany) {
    // ä½¿ç”¨æ–°æ³¨å†Œä¼ä¸šï¼Œè·³è½¬åˆ°æ³¨å†Œé¡µé¢
    uni.navigateTo({
      url: '/pages/profile/company-registration-list'
    })
  } else {
    // ä½¿ç”¨å·²è®¤è¯ä¼ä¸šï¼Œæ ¹æ®company.typeè‡ªåŠ¨å½’ç±»
    uni.showToast({
      title: `ä½¿ç”¨"${company!.name}"ï¼ˆ${company!.typeLabel}ï¼‰æ·»åŠ å°ç¨‹åº`,
      icon: 'success'
    })
    // TODO: æ ¹æ®company.typeå°†å°ç¨‹åºæ·»åŠ åˆ°å¯¹åº”ç±»å‹çš„å…¬å¸ä¸‹
  }
}
</script>
```

---

## åˆ‡æ¢ç‰ˆä½“æ­¥éª¤

1. **ä¿®æ”¹å¯¼å…¥è¯­å¥**:
   ```vue
   // ä»ç‰ˆä½“1åˆ‡æ¢åˆ°ç‰ˆä½“2
   import CompanyListLayout2 from '@/components/company/CompanyListLayout2.vue'
   ```

2. **ä¿®æ”¹æ¨¡æ¿æ ‡ç­¾**:
   ```vue
   <!-- å°† CompanyListLayout1 æ”¹ä¸º CompanyListLayout2 -->
   <CompanyListLayout2
     :companies="allCompanies"
     :authenticated-companies="authenticatedCompanies"
     @program-click="handleProgramClick"
     @add-program="handleAddProgram"
   />
   ```

3. **è°ƒæ•´äº‹ä»¶å¤„ç†å‡½æ•°**:
   ```typescript
   // ç‰ˆä½“1çš„äº‹ä»¶å¤„ç†
   const handleAddProgram = (
     useNewCompany: boolean,
     company: AuthenticatedCompany | null,
     targetCompany: Company  // ç‰ˆä½“1æœ‰ç¬¬ä¸‰ä¸ªå‚æ•°
   ) => {
     // ...
   }

   // ç‰ˆä½“2çš„äº‹ä»¶å¤„ç†
   const handleAddProgram = (
     useNewCompany: boolean,
     company: AuthenticatedCompany | null  // ç‰ˆä½“2åªæœ‰ä¸¤ä¸ªå‚æ•°
   ) => {
     // éœ€è¦æ ¹æ®company.typeè‡ªåŠ¨å½’ç±»
   }
   ```

---

## å…³é”®å·®å¼‚æ€»ç»“

| ç‰¹æ€§ | ç‰ˆä½“1 (å†…è”æŒ‰é’®) | ç‰ˆä½“2 (æ‚¬æµ®æŒ‰é’®) |
|------|------------------|------------------|
| æŒ‰é’®ä½ç½® | æ¯ä¸ªå…¬å¸å†…éƒ¨ | é¡µé¢å³ä¸‹è§’å›ºå®š |
| ä¸‹æ‹‰ç­›é€‰ | æŒ‰å…¬å¸ç±»å‹ç­›é€‰ | æ˜¾ç¤ºæ‰€æœ‰ç±»å‹ |
| ç›®æ ‡å…¬å¸ | æ˜ç¡®ï¼ˆtargetCompanyï¼‰ | è‡ªåŠ¨å½’ç±»ï¼ˆcompany.typeï¼‰ |
| ä¸Šä¸‹æ–‡ | å¼ºå…³è” | å¼±å…³è” |
| é€‚ç”¨åœºæ™¯ | å›´ç»•ç‰¹å®šå…¬å¸æ“ä½œ | é«˜é¢‘æ·»åŠ ã€å¿«é€Ÿæ“ä½œ |

---

## æ³¨æ„äº‹é¡¹

1. **æŒ‰é’®æ˜¾ç¤ºæ¡ä»¶**: ä¸¤ä¸ªç‰ˆä½“éƒ½åªæœ‰åœ¨ `company.miniPrograms.length < company.maxPrograms` æ—¶æ‰æ˜¾ç¤º"æ·»åŠ å°ç¨‹åº"æŒ‰é’®
2. **å¼¹çª—ç»„ä»¶**: ä¸¤ä¸ªç‰ˆä½“éƒ½å…±ç”¨ `AddProgramModal` ç»„ä»¶
3. **ç±»å‹å®‰å…¨**: ä½¿ç”¨TypeScriptæ¥å£å®šä¹‰ï¼Œç¡®ä¿ç±»å‹å®‰å…¨
4. **äº‹ä»¶å‚æ•°**: æ³¨æ„ä¸¤ä¸ªç‰ˆä½“çš„ `@add-program` äº‹ä»¶å‚æ•°ä¸åŒ

---

## æ›´æ–°æ—¥å¿—

- 2026-02-13: åˆ›å»ºä¸¤ä¸ªç‰ˆä½“ç»„ä»¶åŠä½¿ç”¨æ‰‹å†Œ
