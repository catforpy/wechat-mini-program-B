# 新"我的"页面架构设计文档

## 📋 页面架构总览

### 核心理念
**一个用户 → 多个公司主体 → 每个公司对应独立的小程序资产**

```
新"我的"页面
├── 我的注册 ⬇️（默认展开）
│   ├── 公司A（餐饮）→ 点击进入 → 该公司的专属管理页面
│   ├── 公司B（零售）→ 点击进入 → 该公司的专属管理页面
│   └── 公司C（教育）→ 点击进入 → 该公司的专属管理页面
│
├── 我的合作 ▶️（默认折叠）
│   └── 合作小程序列表
│
├── 我的租赁 ▶️（默认折叠）
│   └── 租赁小程序列表
│
├── 我的关注 ⭐（展开）
│   └── 已关注列表
│
└── 我的钱包 💰（展开）
    └── 余额、充值、提现、记录
```

---

## 🎯 为什么需要这样设计？

### 问题背景
当前的"我的"页面只能管理**一个公司**的小程序，但实际业务中：
- ✅ 一个用户可能有**10家不同的公司**
- ✅ 每家公司有**不同的主营范围**和**资质**
- ✅ 不同主营范围的公司可以申请**不同类型的小程序**
  - 餐饮公司 → 餐饮点餐小程序
  - 教育公司 → 在线教育小程序
  - 零售公司 → 商城小程序

### 解决方案
**新"我的"页面**：
- 管理**公司列表**（资质管理）
- 点击某个公司 → 进入**该公司专属的管理页面**（当前的 profile/index.vue）
- 每个公司的管理页面**相互独立**，数据隔离

---

## 📦 五大功能模块详解

### 1️⃣ 我的注册（可折叠，默认展开）

#### 显示内容：
- **公司列表卡片**：
  - 公司名称
  - 公司类型（🏢 企业 / 👤 个体工商户）
  - 认证状态（✓ 已审核 / 正在审核中 / 草稿）
  - 统一社会信用代码
  - 注册日期
  - 该公司名下的小程序数量
  - 点击进入 → 该公司的专属管理页面

- **添加新资质按钮**：
  - 支持添加企业资质
  - 支持添加个体工商户资质

#### 交互设计：
- 点击整个卡片 → 进入该公司的管理页面
- 点击折叠按钮 → 展开/收起列表
- **长按卡片** → 显示操作菜单：
  - 修改（草稿、已审核状态可用，审核中不可用）
  - 删除（草稿可用，已审核需先处理小程序，审核中不可用）

#### 状态说明：
- **已审核**（绿色徽章）：已通过认证，可以正常购买和管理小程序
- **正在审核中**（橙色徽章）：已提交审核，等待审核结果，不可修改删除
- **草稿**（蓝色徽章）：未提交但已保存的资质信息，可以修改和删除

#### 示例数据：
```javascript
{
  id: 1,
  name: '上海XX科技有限公司',
  type: 'company',              // 企业
  status: 'active',             // 已审核 | pending（审核中） | draft（草稿）
  unifiedSocialCreditCode: '91310000XXXXXXXXXX',
  registrationDate: '2020-01-15',
  miniProgramCount: 3,          // 该公司有3个小程序
  businessScope: '软件开发、小程序开发'
}
```

---

### 2️⃣ 我的合作（可折叠，默认折叠）

#### 显示内容：
- **合作小程序列表**：
  - 小程序图标、名称
  - 合作角色（战略合作方/普通合作方）
  - 合作时间

- **操作按钮**：
  - 添加合作资质
  - 增加合作小程序

#### 示例数据：
```javascript
{
  id: 1,
  name: 'XX连锁餐饮点餐系统',
  emoji: '🍔',
  role: '战略合作方',
  cooperationDate: '2024-01-01'
}
```

---

### 3️⃣ 我的租赁（可折叠，默认折叠）

#### 显示内容：
- **租赁小程序列表**：
  - 小程序图标、名称
  - 租赁期限（2024-01 ~ 2024-12）
  - 月租费用（¥299/月）

- **操作按钮**：
  - 添加租赁资质
  - 增加租赁小程序

#### 示例数据：
```javascript
{
  id: 1,
  name: '零售商城小程序',
  emoji: '🛒',
  period: '2024-01 ~ 2024-12',
  monthlyFee: '¥299/月'
}
```

---

### 4️⃣ 我的关注（展开显示）

#### 显示内容：
- **关注列表**：
  - 小程序模板
  - 小程序
  - App
  - 每项显示：图标、名称、类型
  - 每项有"取消关注"按钮

- **空状态提示**：
  - 还没有关注任何内容
  - 去首页发现更多精彩小程序吧~

#### 示例数据：
```javascript
{
  id: 1,
  name: '餐饮点餐模板',
  type: '小程序模板',
  emoji: '🍔'
}
```

---

### 5️⃣ 我的钱包（展开显示）

#### 显示内容：
- **余额卡片**：
  - 左侧：🌰 都达豆（10000）
  - 中间：兑换比例（10:1）竖向显示
  - 右侧：💴 人民币（¥1000）

- **操作按钮**：
  - 💳 充值（绿色）
  - 💸 提现（橙色）
  - 📋 充值记录（蓝色）

#### 示例数据：
```javascript
{
  douDou: 10000,  // 都达豆
  rmb: 1000       // 人民币（10000都达豆 = 1000人民币）
}
```

---

## 🔄 页面跳转关系

### 核心跳转：
```
新"我的"页面（index-new.vue）
└── 点击某个公司卡片
    └── → company-detail.vue?companyId=1&name=上海XX科技有限公司&type=company
        ├── 我的小程序（显示该公司的小程序列表）
        ├── 模板市场（显示可购买的模板）
        ├── 数据统计（该公司的小程序数据）
        └── 小程序设置（该公司的设置）
```

### URL参数说明：
```javascript
/pages/profile/company-detail?companyId=1&name=上海XX科技有限公司&type=company

├── companyId: 公司ID（用于加载该公司的小程序数据）
├── name: 公司名称（用于页面标题显示）
└── type: 公司类型（company企业 / individual个体工商户）
```

---

## 📁 文件结构

### 当前状态：
```
pages/profile/
├── index.vue                  # 旧版"我的"页面（当前使用）
├── index-new.vue              # 新版"我的"页面（刚设计完成）⭐
├── mini-programs.vue          # 我的小程序列表
└── ...

backup/profile-20250210/      # 备份
└── profile/
    └── index.vue              # 旧版备份
```

### 目标结构：
```
pages/profile/
├── index.vue                  # 新版"我的"页面（替换当前index.vue）
├── company-detail.vue         # 公司详情页（=当前的index.vue，根据companyId加载数据）
├── mini-programs.vue          # 我的小程序列表
├── add-qualification.vue       # 添加资质页（待创建）
└── recharge-records.vue       # 充值记录页（待创建）
```

---

## 💾 数据流程

### 1. 用户进入新"我的"页面
```
index-new.vue 加载
↓
显示所有公司资质（qualifications）
```

### 2. 点击某个公司
```
goToCompanyDetail(qualification)
↓
跳转: company-detail.vue?companyId=1&name=xxx&type=company
```

### 3. company-detail.vue 加载数据
```javascript
// company-detail.vue
onMounted(() => {
  const companyId = getQueryParam('companyId')

  // 根据companyId加载该公司的小程序数据
  loadMiniPrograms(companyId)
  loadCompanyInfo(companyId)
})

const loadMiniPrograms = (companyId: number) => {
  // 调用API，获取该公司名下的小程序
  api.getMiniPrograms({ companyId }).then(data => {
    miniPrograms.value = data
  })
}
```

---

## 🎨 设计特点

### 1. 清晰的层级关系
- 新"我的"页面：**公司列表管理**
- company-detail页面：**单家公司的小程序管理**

### 2. 数据隔离
- 不同公司的小程序**完全隔离**
- companyId 作为**数据隔离的核心标识**

### 3. 可扩展性
- 支持用户添加**无限个**公司资质
- 每个公司可以有**无限个**小程序

### 4. 用户友好
- 默认展开"我的注册"，突出核心功能
- 其他模块默认折叠，减少信息过载
- 卡片式设计，点击区域大

---

## 🚀 下一步工作

### 必须完成：
1. ✅ 设计新版"我的"页面（已完成）
2. ✅ 添加状态徽章：已审核、正在审核中、草稿（已完成）
3. ✅ 实现长按操作菜单：修改、删除（已完成）
4. ⏳ 创建 company-detail.vue（基于当前的index.vue）
5. ⏳ 修改数据加载逻辑，根据companyId加载
6. ⏳ 创建添加资质页面（支持企业和个体工商户）

### 可选功能：
1. ⏳ 创建充值记录页
2. ⏳ 完善钱包功能
3. ⏳ 添加合作/租赁管理

---

## ❓ 待确认问题

1. **公司数据存储**：是否后端已支持多公司数据结构？
2. **小程序关联**：小程序是否已绑定到特定公司？
3. **权限管理**：不同公司是否有不同的管理权限？

---

**创建时间**：2025-02-10
**文档版本**：v2.0
**设计状态**：✅ 已理解需求，页面设计中
