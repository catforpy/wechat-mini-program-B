# å…¬å…±æ¨¡å—ä½¿ç”¨æŒ‡å—

> æœ¬æ–‡æ¡£è¯´æ˜å¦‚ä½•ä½¿ç”¨é¡¹ç›®ä¸­å·²åˆ›å»ºçš„çŠ¶æ€ç®¡ç†ã€ç»„ä»¶åº“å’Œ Composables

**æœ€åæ›´æ–°**: 2026-02-07

---

## ğŸ“š ç›®å½•

- [ä¸€ã€çŠ¶æ€ç®¡ç† (Pinia Stores)](#ä¸€çŠ¶æ€ç®¡ç†-pinia-stores)
- [äºŒã€åŸºç¡€ç»„ä»¶åº“](#äºŒåŸºç¡€ç»„ä»¶åº“)
- [ä¸‰ã€ä¸šåŠ¡ç»„ä»¶åº“](#ä¸‰ä¸šåŠ¡ç»„ä»¶åº“)
- [å››ã€Composables](#å››composables)
- [äº”ã€å®Œæ•´ç¤ºä¾‹](#äº”å®Œæ•´ç¤ºä¾‹)

---

## ä¸€ã€çŠ¶æ€ç®¡ç† (Pinia Stores)

### 1.1 åº”ç”¨çŠ¶æ€ (useAppStore)

```typescript
import { useAppStore } from '@/stores'

const appStore = useAppStore()

// è·å–çŠ¶æ€
console.log(appStore.theme)
console.log(appStore.isDark)
console.log(appStore.networkStatus)

// è°ƒç”¨æ–¹æ³•
await appStore.init()
await appStore.setTheme('dark')
await appStore.toggleTheme()
await appStore.setLanguage('en-US')
appStore.showLoading()
appStore.hideLoading()
```

### 1.2 ç”¨æˆ·çŠ¶æ€ (useUserStore)

```typescript
import { useUserStore } from '@/stores'

const userStore = useUserStore()

// è·å–çŠ¶æ€
console.log(userStore.isLoggedIn)
console.log(userStore.userInfo)
console.log(userStore.userName)

// è°ƒç”¨æ–¹æ³•
await userStore.init()
const success = await userStore.login({ username, password })
await userStore.logout()
await userStore.getUserInfo()
await userStore.updateUserInfo({ nickname: 'æ–°æ˜µç§°' })
userStore.hasPermission('user:edit')
userStore.hasRole('admin')
```

---

## äºŒã€åŸºç¡€ç»„ä»¶åº“

### 2.1 Button æŒ‰é’®

```vue
<template>
  <!-- åŸºç¡€ç”¨æ³• -->
  <x-button>é»˜è®¤æŒ‰é’®</x-button>

  <!-- ä¸åŒç±»å‹ -->
  <x-button type="primary">ä¸»è¦æŒ‰é’®</x-button>
  <x-button type="success">æˆåŠŸæŒ‰é’®</x-button>
  <x-button type="warning">è­¦å‘ŠæŒ‰é’®</x-button>
  <x-button type="danger">å±é™©æŒ‰é’®</x-button>
  <x-button type="text">æ–‡å­—æŒ‰é’®</x-button>

  <!-- ä¸åŒå°ºå¯¸ -->
  <x-button size="small">å°æŒ‰é’®</x-button>
  <x-button size="medium">ä¸­æŒ‰é’®</x-button>
  <x-button size="large">å¤§æŒ‰é’®</x-button>

  <!-- ç¦ç”¨çŠ¶æ€ -->
  <x-button disabled>ç¦ç”¨æŒ‰é’®</x-button>

  <!-- åŠ è½½çŠ¶æ€ -->
  <x-button loading>åŠ è½½ä¸­</x-button>

  <!-- ç‚¹å‡»äº‹ä»¶ -->
  <x-button @click="handleClick">ç‚¹å‡»æˆ‘</x-button>
</template>

<script setup lang="ts">
const handleClick = () => {
  console.log('æŒ‰é’®è¢«ç‚¹å‡»')
}
</script>
```

### 2.2 Input è¾“å…¥æ¡†

```vue
<template>
  <!-- åŸºç¡€ç”¨æ³• -->
  <x-input v-model="value" placeholder="è¯·è¾“å…¥å†…å®¹" />

  <!-- å¸¦æ ‡ç­¾ -->
  <x-input v-model="username" label="ç”¨æˆ·å" />

  <!-- å¯†ç æ¡† -->
  <x-input v-model="password" type="password" label="å¯†ç " />

  <!-- å¯æ¸…ç©º -->
  <x-input v-model="value" clearable />

  <!-- é”™è¯¯çŠ¶æ€ -->
  <x-input v-model="value" error />

  <!-- ç¦ç”¨ -->
  <x-input v-model="value" disabled />

  <!-- äº‹ä»¶ -->
  <x-input
    v-model="value"
    @focus="handleFocus"
    @blur="handleBlur"
    @confirm="handleConfirm"
  />
</template>

<script setup lang="ts">
import { ref } from 'vue'

const value = ref('')
const username = ref('')
const password = ref('')

const handleFocus = () => console.log('èšç„¦')
const handleBlur = () => console.log('å¤±ç„¦')
const handleConfirm = () => console.log('ç¡®è®¤')
</script>
```

### 2.3 Modal æ¨¡æ€æ¡†

```vue
<template>
  <x-button @click="visible = true">æ˜¾ç¤ºæ¨¡æ€æ¡†</x-button>

  <x-modal
    v-model:visible="visible"
    title="æç¤º"
    @confirm="handleConfirm"
    @cancel="handleCancel"
  >
    <view>è¿™æ˜¯æ¨¡æ€æ¡†å†…å®¹</view>
  </x-modal>
</template>

<script setup lang="ts">
import { ref } from 'vue'

const visible = ref(false)

const handleConfirm = () => {
  console.log('ç‚¹å‡»ç¡®å®š')
  visible.value = false
}

const handleCancel = () => {
  console.log('ç‚¹å‡»å–æ¶ˆ')
}
</script>
```

### 2.4 Loading åŠ è½½

```vue
<template>
  <x-loading :visible="loading" text="åŠ è½½ä¸­..." />
</template>

<script setup lang="ts">
import { ref } from 'vue'

const loading = ref(true)
</script>
```

### 2.5 Empty ç©ºçŠ¶æ€

```vue
<template>
  <!-- é»˜è®¤ -->
  <x-empty />

  <!-- è‡ªå®šä¹‰æè¿° -->
  <x-empty description="æš‚æ— æ•°æ®" />

  <!-- è‡ªå®šä¹‰å›¾ç‰‡ -->
  <x-empty image="/static/images/empty.png" description="è¿˜æ²¡æœ‰è®¢å•å“¦" />
</template>
```

---

## ä¸‰ã€ä¸šåŠ¡ç»„ä»¶åº“

### 3.1 UserCard ç”¨æˆ·å¡ç‰‡

```vue
<template>
  <user-card
    :user="userInfo"
    :show-role="true"
    @click="handleUserClick"
  />
</template>

<script setup lang="ts">
import type { UserInfo } from '@/types'

const userInfo: UserInfo = {
  id: 1,
  username: 'admin',
  nickname: 'ç®¡ç†å‘˜',
  avatar: '/static/avatar.png',
  role: 'admin',
  status: 'active',
  createTime: '2026-01-01'
}

const handleUserClick = (user: UserInfo) => {
  console.log('ç‚¹å‡»ç”¨æˆ·:', user)
}
</script>
```

### 3.2 Card å¡ç‰‡

```vue
<template>
  <!-- åŸºç¡€å¡ç‰‡ -->
  <card title="æ ‡é¢˜">
    <view>å¡ç‰‡å†…å®¹</view>
  </card>

  <!-- æ— é˜´å½± -->
  <card title="æ ‡é¢˜" :shadow="false">
    <view>å†…å®¹</view>
  </card>

  <!-- å¯ç‚¹å‡» -->
  <card title="æ ‡é¢˜" clickable @click="handleClick">
    <view>å†…å®¹</view>
  </card>

  <!-- å¸¦é¡µè„š -->
  <card title="æ ‡é¢˜">
    <view>å†…å®¹</view>
    <template #footer>
      <x-button>æ“ä½œ</x-button>
    </template>
  </card>

  <!-- è‡ªå®šä¹‰é¢å¤–å†…å®¹ -->
  <card title="æ ‡é¢˜">
    <view>å†…å®¹</view>
    <template #extra>
      <text>é¢å¤–å†…å®¹</text>
    </template>
  </card>
</template>
```

### 3.3 ListItem åˆ—è¡¨é¡¹

```vue
<template>
  <!-- åŸºç¡€åˆ—è¡¨é¡¹ -->
  <list-item title="æ ‡é¢˜" note="æè¿°" />

  <!-- å¸¦å›¾æ ‡ -->
  <list-item title="è®¾ç½®" icon="âš™ï¸" />

  <!-- å¸¦å¤´åƒ -->
  <list-item title="ç”¨æˆ·å" note="ä¸ªäººç®€ä»‹" avatar="/static/avatar.png" />

  <!-- æ— ç®­å¤´ -->
  <list-item title="æ ‡é¢˜" :arrow="false" />

  <!-- è‡ªå®šä¹‰é¢å¤–å†…å®¹ -->
  <list-item title="æ ‡é¢˜">
    <template #extra>
      <text>é¢å¤–å†…å®¹</text>
    </template>
  </list-item>

  <!-- ç‚¹å‡»äº‹ä»¶ -->
  <list-item title="æ ‡é¢˜" @click="handleClick" />
</template>
```

### 3.4 Navbar å¯¼èˆªæ 

```vue
<template>
  <!-- åŸºç¡€å¯¼èˆªæ  -->
  <navbar title="é¡µé¢æ ‡é¢˜" />

  <!-- è‡ªå®šä¹‰èƒŒæ™¯è‰² -->
  <navbar title="é¡µé¢æ ‡é¢˜" background-color="#ff0000" />

  <!-- ä¸æ˜¾ç¤ºè¿”å›æŒ‰é’® -->
  <navbar title="é¦–é¡µ" :show-back="false" />

  <!-- æ˜¾ç¤ºé¦–é¡µæŒ‰é’® -->
  <navbar title="è¯¦æƒ…é¡µ" :show-home="true" />

  <!-- è‡ªå®šä¹‰é¢å¤–å†…å®¹ -->
  <navbar title="é¡µé¢æ ‡é¢˜">
    <template #extra>
      <text>åˆ†äº«</text>
    </template>
  </navbar>
</template>
```

### 3.5 Tabbar åº•éƒ¨å¯¼èˆª

```vue
<template>
  <tabbar
    :items="tabItems"
    :active-index="activeIndex"
    @change="handleTabChange"
  />
</template>

<script setup lang="ts">
import { ref } from 'vue'

const activeIndex = ref(0)

const tabItems = [
  {
    icon: 'ğŸ ',
    activeIcon: 'ğŸ ',
    label: 'é¦–é¡µ',
    url: '/pages/index/index'
  },
  {
    icon: 'ğŸ“‹',
    activeIcon: 'ğŸ“‹',
    label: 'è®¢å•',
    url: '/pages/order/index'
  },
  {
    icon: 'ğŸ‘¤',
    activeIcon: 'ğŸ‘¤',
    label: 'æˆ‘çš„',
    url: '/pages/user/index'
  }
]

const handleTabChange = (index: number, item: any) => {
  activeIndex.value = index
  console.log('åˆ‡æ¢åˆ°:', item.label)
}
</script>
```

---

## å››ã€Composables

### 4.1 useAuth è®¤è¯

```typescript
import { useAuth } from '@/composables'

const {
  isLoggedIn,
  userInfo,
  userName,
  isAdmin,
  login,
  logout,
  hasPermission,
  requireAuth
} = useAuth()

// ç™»å½•
const success = await login('username', 'password')

// é€€å‡º
await logout()

// æƒé™æ£€æŸ¥
if (hasPermission('user:edit')) {
  // æœ‰æƒé™
}

// éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®
if (requireAuth()) {
  // å·²ç™»å½•ï¼Œç»§ç»­æ“ä½œ
}
```

### 4.2 useRequest è¯·æ±‚

```typescript
import { useRequest } from '@/composables'

const { loading, error, get, post, put, delete } = useRequest()

// GET è¯·æ±‚
const data = await get('/api/user/info')

// POST è¯·æ±‚
await post('/api/user/create', { name: 'å¼ ä¸‰' })

// å¸¦åŠ è½½çŠ¶æ€
if (!loading.value) {
  await post('/api/data', payload)
}
```

### 4.3 useForm è¡¨å•

```typescript
import { useForm, formRules } from '@/composables'

// è¡¨å•æ•°æ®
const { formData, errors, submitting, validate, handleSubmit } = useForm(
  {
    username: '',
    password: '',
    email: ''
  },
  {
    username: [formRules.required('è¯·è¾“å…¥ç”¨æˆ·å')],
    password: [formRules.required('è¯·è¾“å…¥å¯†ç '), formRules.password()],
    email: [formRules.required('è¯·è¾“å…¥é‚®ç®±'), formRules.email()]
  }
)

// æäº¤è¡¨å•
await handleSubmit(async (data) => {
  // data æ˜¯è¡¨å•æ•°æ®
  await api.submit(data)
})

// éªŒè¯è¡¨å•
const isValid = validate()
```

### 4.4 useUpload ä¸Šä¼ 

```typescript
import { useUpload } from '@/composables'

const { uploading, chooseImage, uploadFile, chooseAndUpload } = useUpload()

// é€‰æ‹©å¹¶ä¸Šä¼ 
const urls = await chooseAndUpload({ count: 9 })

// é€‰æ‹©å›¾ç‰‡
const filePaths = await chooseImage({ count: 1 })

// ä¸Šä¼ å•ä¸ªæ–‡ä»¶
const url = await uploadFile(filePaths[0])
```

### 4.5 usePagination åˆ†é¡µ

```typescript
import { usePagination } from '@/composables'

const { page, pageSize, total, hasMore, nextPage, prevPage, goToPage } = usePagination(20)

// ä¸‹ä¸€é¡µ
if (hasMore.value) {
  nextPage()
}

// è·³è½¬åˆ°æŒ‡å®šé¡µ
goToPage(5)
```

---

## äº”ã€å®Œæ•´ç¤ºä¾‹

### 5.1 ç™»å½•é¡µé¢

```vue
<template>
  <view class="login-page">
    <view class="login-form">
      <x-input
        v-model="formData.username"
        label="è´¦å·"
        placeholder="è¯·è¾“å…¥è´¦å·"
        :error="!!errors.username"
        clearable
      />

      <x-input
        v-model="formData.password"
        type="password"
        label="å¯†ç "
        placeholder="è¯·è¾“å…¥å¯†ç "
        :error="!!errors.password"
        clearable
      />

      <x-button
        type="primary"
        size="large"
        :loading="submitting"
        @click="handleLogin"
      >
        ç™»å½•
      </x-button>
    </view>
  </view>
</template>

<script setup lang="ts">
import { useForm, formRules } from '@/composables'
import { useAuth } from '@/composables'

const { login } = useAuth()

const { formData, errors, submitting, handleSubmit } = useForm(
  {
    username: '',
    password: ''
  },
  {
    username: [formRules.required('è¯·è¾“å…¥è´¦å·')],
    password: [formRules.required('è¯·è¾“å…¥å¯†ç ')]
  }
)

const handleLogin = async () => {
  await handleSubmit(async () => {
    const success = await login(formData.username, formData.password)
    if (success) {
      uni.reLaunch({ url: '/pages/index/index' })
    }
  })
}
</script>
```

### 5.2 åˆ—è¡¨é¡µé¢

```vue
<template>
  <view class="list-page">
    <navbar title="è®¢å•åˆ—è¡¨" />

    <view class="content">
      <card v-for="item in list" :key="item.id" @click="handleItemClick(item)">
        <view class="order-info">
          <text>è®¢å•å·: {{ item.orderNo }}</text>
          <text>é‡‘é¢: Â¥{{ item.amount }}</text>
        </view>
      </card>
    </view>

    <x-loading :visible="loading" />
  </view>
</template>

<script setup lang="ts">
import { useList } from '@/composables'
import { httpRequest } from '@/utils'

const { list, loading, loadData, refresh } = useList<Order>()

// åŠ è½½æ•°æ®
loadData(async (page, pageSize) => {
  return await httpRequest.get('/orders', { page, pageSize })
})

// ä¸‹æ‹‰åˆ·æ–°
onPullDownRefresh(async () => {
  await refresh(() => httpRequest.get('/orders', { page: 1, pageSize: 20 }))
  uni.stopPullDownRefresh()
})
</script>
```

---

## å…­ã€æœ€ä½³å®è·µ

### 6.1 ç»„ä»¶æ³¨å†Œ

å»ºè®®åœ¨é¡µé¢ä¸­æŒ‰éœ€å¼•å…¥ç»„ä»¶ï¼š

```vue
<script setup lang="ts">
import XButton from '@/components/base/Button.vue'
import Card from '@/components/business/Card.vue'
</script>
```

### 6.2 Store ä½¿ç”¨

åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ Storeï¼š

```vue
<script setup lang="ts">
import { useUserStore } from '@/stores'

const userStore = useUserStore()
// ç›´æ¥ä½¿ç”¨
</script>
```

### 6.3 TypeScript ç±»å‹

å§‹ç»ˆä½¿ç”¨ç±»å‹å®šä¹‰ï¼š

```typescript
import type { UserInfo, LoginParams } from '@/types'

const userInfo: UserInfo = { }
const loginParams: LoginParams = { }
```

---

**æ–‡æ¡£ç»´æŠ¤**: è¯·éšç€é¡¹ç›®å‘å±•åŠæ—¶æ›´æ–°æœ¬æ–‡æ¡£

**ç›¸å…³æ–‡æ¡£**:
- [Uniappå¼€å‘æ‰‹å†Œ-æ¶æ„ä¸æœ€ä½³å®è·µ.md](./Uniappå¼€å‘æ‰‹å†Œ-æ¶æ„ä¸æœ€ä½³å®è·µ.md)
- [åŸºç¡€è®¾æ–½ä½¿ç”¨æŒ‡å—.md](./åŸºç¡€è®¾æ–½ä½¿ç”¨æŒ‡å—.md)
